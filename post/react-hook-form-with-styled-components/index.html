<!doctype html><html><head><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=twitter:image:src content="https://shota.coffee/images/og/default-og-img.png"><meta property="og:image" content="https://shota.coffee/images/og/default-og-img.png"><meta property="og:title" content="codesign"><meta property="og:site_name" content="codesign"><meta name=description content="shotaCoffeeのブログです"><meta property="og:description" content="shotaCoffeeのブログです"><meta property="og:image" content="https://shota.coffee/images/og/react-hook-form-with-styled-components.png"><meta name=twitter:image:src content="https://shota.coffee/images/og/react-hook-form-with-styled-components.png"><meta property="og:title" content="React Hook Form と Styled Components を一緒に使いたい | codesign"><meta property="og:site_name" content="React Hook Form と Styled Components を一緒に使いたい | codesign"><meta name=description content><meta property="og:description" content><meta property="og:locale" content="ja"><meta property="og:image:width" content="600"><meta property="og:image:height" content="315"><meta property="og:type" content="website"><meta name=twitter:site content="@shota_coffee"><meta name=twitter:card content="summary_large_image"><meta property="fb:app_id" content="2709602549147832"><link rel=icon type=image/x-icon href=/favicon.ico><link rel=stylesheet href=https://shota.coffee/styles/main.css><meta charset=utf-8><title>React Hook Form と Styled Components を一緒に使いたい</title></head><body><header class=header><nav class=navigation><ul><li><a href=/><img src=/images/logo.svg alt=codesign></a></li></ul><h1>codesign</h1></nav></header><div class=post><h2>React Hook Form と Styled Components を一緒に使いたい</h2><div class=post-meta><div class=posted>2020.12.27</div><div class=categories><ul><li class=text-small><a href=/tags/React/>React</a></li></ul></div></div><h2 id=解決したいこと>解決したいこと</h2><ul><li>React Hook Form の register をいい感じに Styled-Components に渡したい。</li><li>Styled-Components の ref の型といい感じに合わせたい。</li></ul><h2 id=環境>環境</h2><div class=highlight><pre class=chroma><code class=language-tsx data-lang=tsx><span class=s2>&#34;react&#34;</span><span class=o>:</span> <span class=s2>&#34;^16.13.1&#34;</span><span class=p>,</span>
<span class=s2>&#34;react-hook-form&#34;</span><span class=o>:</span> <span class=s2>&#34;^6.9.6&#34;</span><span class=p>,</span>
<span class=s2>&#34;styled-components&#34;</span><span class=o>:</span> <span class=s2>&#34;^5.1.1&#34;</span><span class=p>,</span>
<span class=s2>&#34;typescript&#34;</span><span class=o>:</span> <span class=s2>&#34;~3.7.2&#34;</span>
</code></pre></div><h2 id=解決方法>解決方法</h2><ul><li>Styled Components が認識できるように型を書いてあげる。</li></ul><h3 id=コンポーネント側>コンポーネント側</h3><div class=highlight><pre class=chroma><code class=language-tsx data-lang=tsx><span class=kr>type</span> <span class=nx>RefReturn</span> <span class=o>=</span>
  <span class=o>|</span> <span class=kt>string</span>
  <span class=o>|</span> <span class=p>((</span><span class=nx>instance</span>: <span class=kt>HTMLInputElement</span> <span class=o>|</span> <span class=kc>null</span><span class=p>)</span> <span class=o>=&gt;</span> <span class=k>void</span><span class=p>)</span>
  <span class=o>|</span> <span class=nx>React</span><span class=p>.</span><span class=nx>RefObject</span><span class=p>&lt;</span><span class=nt>HTMLInputElement</span><span class=p>&gt;</span>
  <span class=o>|</span> <span class=kc>null</span>
  <span class=o>|</span> <span class=kc>undefined</span><span class=p>;</span>

<span class=kr>type</span> <span class=nx>Props</span> <span class=o>=</span> <span class=nx>React</span><span class=p>.</span><span class=nx>DetailedHTMLProps</span><span class=p>&lt;</span><span class=nt>React.InputHTMLAttributes</span><span class=err>&lt;</span><span class=na>HTMLInputElement</span><span class=p>&gt;,</span>
  <span class=nx>HTMLInputElement</span><span class=o>&gt;</span> <span class=o>&amp;</span> <span class=p>{</span>
  <span class=nx>placeholder?</span>: <span class=kt>string</span>
  <span class=nx>name</span>: <span class=kt>string</span>
  <span class=nx>register</span><span class=o>:</span> <span class=p>({</span><span class=nx>required</span><span class=p>}</span><span class=o>:</span> <span class=p>{</span> <span class=nx>required?</span>: <span class=kt>boolean</span> <span class=p>})</span> <span class=o>=&gt;</span> <span class=nx>RefReturn</span><span class=p>;</span>
<span class=p>};</span>

<span class=kr>type</span> <span class=nx>Ref</span> <span class=o>=</span> <span class=p>(</span><span class=nx>instance</span>: <span class=kt>HTMLInputElement</span> <span class=o>|</span> <span class=kc>null</span><span class=p>)</span> <span class=o>=&gt;</span> <span class=k>void</span> <span class=o>|</span> <span class=nx>React</span><span class=p>.</span><span class=nx>RefObject</span><span class=p>&lt;</span><span class=nt>HTMLInputElement</span><span class=p>&gt;</span> <span class=o>|</span> <span class=kc>null</span> <span class=o>|</span> <span class=kc>undefined</span>

<span class=kr>const</span> <span class=nx>FormInput</span> <span class=o>=</span> <span class=p>({</span><span class=nx>name</span><span class=p>,</span> <span class=nx>register</span><span class=p>,</span> <span class=nx>required</span><span class=p>,</span> <span class=nx>placeholder</span><span class=p>}</span><span class=o>:</span> <span class=nx>Props</span><span class=p>)</span> <span class=o>=&gt;</span> <span class=p>{</span>
  <span class=k>return</span> <span class=p>(</span>
    <span class=p>&lt;</span><span class=nt>Input</span>
      <span class=na>type</span><span class=o>=</span><span class=s>&#34;text&#34;</span>
      <span class=na>placeholder</span><span class=o>=</span><span class=p>{</span><span class=nx>placeholder</span><span class=p>}</span>
      <span class=na>name</span><span class=o>=</span><span class=p>{</span><span class=nx>name</span><span class=p>}</span>
      <span class=na>ref</span><span class=o>=</span><span class=p>{</span><span class=nx>register</span><span class=p>({</span><span class=nx>required</span><span class=p>})</span> <span class=kr>as</span> <span class=nx>Ref</span><span class=p>}</span>
    <span class=p>/&gt;</span>
  <span class=p>)</span>
<span class=p>};</span>
</code></pre></div><h3 id=親コンポーネント>親コンポーネント</h3><div class=highlight><pre class=chroma><code class=language-tsx data-lang=tsx><span class=p>&lt;</span><span class=nt>FormInput</span>
  <span class=na>type</span><span class=o>=</span><span class=s>&#34;password&#34;</span>
  <span class=na>placeholder</span><span class=o>=</span><span class=s>&#34;パスワード&#34;</span>
  <span class=na>name</span><span class=o>=</span><span class=s>&#34;password&#34;</span>
  <span class=na>register</span><span class=o>=</span><span class=p>{</span><span class=nx>register</span><span class=p>}</span>
	<span class=na>required</span>
<span class=p>/&gt;</span>
</code></pre></div><h3 id=参考>参考</h3><ul><li><a href=https://github.com/react-hook-form/react-hook-form/discussions/1681>https://github.com/react-hook-form/react-hook-form/discussions/1681</a></li><li><a href=https://codesandbox.io/s/react-hook-formstyled-components-cboo1?from-embed>https://codesandbox.io/s/react-hook-formstyled-components-cboo1?from-embed</a></li><li><a href=https://styled-components.com/docs/advanced#refs>https://styled-components.com/docs/advanced#refs</a></li><li><a href=https://react-hook-form.com/get-started/#Integratinganexistingform>https://react-hook-form.com/get-started/#Integratinganexistingform</a></li></ul></div></body></html>